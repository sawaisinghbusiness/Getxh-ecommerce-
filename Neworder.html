<script>
    // Services Data
    const servicesData = [
        { serviceId: 1, serviceName: "Instagram Followers – Used by Influencers – Same Day Delivery", category: "Instagram Followers", pricePer1000: 169.43, minQuantity: 100, maxQuantity: 1000000, description: "High quality followers with same day delivery", cancel: "No", drop: "Low", quality: "High" },
        { serviceId: 2, serviceName: "Instagram Followers – Used by Influencers – Same Day Delivery 2", category: "Instagram Followers", pricePer1000: 172.47, minQuantity: 100, maxQuantity: 1000000, description: "Premium followers with guaranteed delivery", cancel: "No", drop: "Low", quality: "High" },
        { serviceId: 3, serviceName: "Instagram Followers – Used by Celebrities – Same Day Delivery", category: "Instagram Followers", pricePer1000: 159.44, minQuantity: 100, maxQuantity: 1000000, description: "Celebrity grade followers", cancel: "No", drop: "Very Low", quality: "Premium" },

        { serviceId: 4, serviceName: "Instagram Reel Views – Real Views", category: "Instagram Reel Views", pricePer1000: 0.36, minQuantity: 100, maxQuantity: 2147483647, description: "100% real views", cancel: "Yes", drop: "No", quality: "Real" },
        { serviceId: 5, serviceName: "Instagram Reel Views – Real Views 2", category: "Instagram Reel Views", pricePer1000: 0.54, minQuantity: 100, maxQuantity: 2147483647, description: "Organic reel views", cancel: "Yes", drop: "No", quality: "Real" },
        { serviceId: 6, serviceName: "Instagram Reel Views – Explore Page Views", category: "Instagram Reel Views", pricePer1000: 0.72, minQuantity: 100, maxQuantity: 2147483647, description: "Explore page views", cancel: "Yes", drop: "No", quality: "Real" },
        { serviceId: 7, serviceName: "Instagram Reel Views – Indian Views", category: "Instagram Reel Views", pricePer1000: 1.08, minQuantity: 100, maxQuantity: 2147483647, description: "Indian audience views", cancel: "Yes", drop: "No", quality: "Indian" },

        { serviceId: 8, serviceName: "Instagram Likes – Influencers", category: "Instagram Likes", pricePer1000: 27.68, minQuantity: 10, maxQuantity: 1000000, description: "High quality likes", cancel: "No", drop: "Low", quality: "High" },
        { serviceId: 9, serviceName: "Instagram Likes – Celebrities", category: "Instagram Likes", pricePer1000: 37.38, minQuantity: 10, maxQuantity: 1000000, description: "Premium likes", cancel: "No", drop: "Very Low", quality: "Premium" },

        { serviceId: 10, serviceName: "Instagram Indian Likes – Influencers", category: "Instagram Indian Likes", pricePer1000: 44.27, minQuantity: 10, maxQuantity: 1000000, description: "Indian likes", cancel: "No", drop: "Low", quality: "Indian" },
        { serviceId: 11, serviceName: "Instagram Indian Likes – Celebrities", category: "Instagram Indian Likes", pricePer1000: 53.01, minQuantity: 10, maxQuantity: 1000000, description: "Premium Indian likes", cancel: "No", drop: "Very Low", quality: "Indian" }
    ];

    // Elements
    const categorySelect = document.getElementById("category-select");
    const serviceSelect = document.getElementById("service-select");
    const searchInput = document.getElementById("search-input");
    const serviceDetails = document.getElementById("service-details");
    const serviceDescription = document.getElementById("service-description");
    const serviceCancel = document.getElementById("service-cancel");
    const serviceDrop = document.getElementById("service-drop");
    const serviceQuality = document.getElementById("service-quality");

    const quantityRange = document.getElementById("quantity-range");
    const quantityInput = document.getElementById("quantity-input");
    const quantityError = document.getElementById("quantity-error");

    const totalPrice = document.getElementById("total-price");
    const placeOrderBtn = document.getElementById("place-order-btn");

    const successModal = document.getElementById("success-modal");
    const viewOrdersBtn = document.getElementById("view-orders-btn");
    const closeModalBtn = document.getElementById("close-modal-btn");

    const recentOrdersContainer = document.getElementById("recent-orders-container");

    let selectedService = null;

    // SEARCH + CATEGORY FILTER
    function populateServices() {
        const category = categorySelect.value;
        const searchTerm = searchInput.value.toLowerCase();

        serviceSelect.innerHTML = '<option value="">Select a service</option>';

        const filtered = servicesData.filter(s =>
            s.category === category &&
            s.serviceName.toLowerCase().includes(searchTerm)
        );

        filtered.forEach(s => {
            const opt = document.createElement("option");
            opt.value = s.serviceId;
            opt.textContent = `${s.serviceName} – ₹${s.pricePer1000}/1000`;
            serviceSelect.appendChild(opt);
        });

        serviceSelect.disabled = filtered.length === 0;
    }

    categorySelect.addEventListener("change", () => {
        populateServices();
        resetServiceUI();
    });

    searchInput.addEventListener("input", populateServices);

    // SERVICE SELECT
    serviceSelect.addEventListener("change", () => {
        const id = parseInt(serviceSelect.value);
        selectedService = servicesData.find(s => s.serviceId === id);

        if (!selectedService) return;

        serviceDetails.classList.remove("hidden");
        serviceDescription.textContent = selectedService.description;
        serviceCancel.textContent = selectedService.cancel;
        serviceDrop.textContent = selectedService.drop;
        serviceQuality.textContent = selectedService.quality;

        quantityRange.textContent =
            `Min: ${selectedService.minQuantity} – Max: ${selectedService.maxQuantity}`;
    });

    // QUANTITY CHANGE → TOTAL PRICE
    quantityInput.addEventListener("input", () => {
        if (!selectedService) return;

        const qty = parseInt(quantityInput.value) || 0;

        if (qty < selectedService.minQuantity || qty > selectedService.maxQuantity) {
            quantityError.classList.remove("hidden");
            placeOrderBtn.disabled = true;
            totalPrice.textContent = "₹0.00";
            return;
        }

        quantityError.classList.add("hidden");

        const price = (qty / 1000) * selectedService.pricePer1000;
        totalPrice.textContent = `₹${price.toFixed(2)}`;

        placeOrderBtn.disabled = false;
    });

    // RESET UI
    function resetServiceUI() {
        serviceSelect.value = "";
        serviceDetails.classList.add("hidden");
        quantityError.classList.add("hidden");
        quantityInput.value = "";
        totalPrice.textContent = "₹0.00";
        placeOrderBtn.disabled = true;
    }

    // PLACE ORDER
    placeOrderBtn.addEventListener("click", () => {
        successModal.classList.remove("hidden");

        const orderHtml = `
            <div class="border rounded-lg p-3 mb-2">
                <p><strong>Service:</strong> ${selectedService.serviceName}</p>
                <p><strong>Quantity:</strong> ${quantityInput.value}</p>
                <p><strong>Total:</strong> ${totalPrice.textContent}</p>
            </div>
        `;
        recentOrdersContainer.innerHTML = orderHtml + recentOrdersContainer.innerHTML;
    });

    // MODAL BUTTONS
    closeModalBtn.addEventListener("click", () => {
        successModal.classList.add("hidden");
    });

    viewOrdersBtn.addEventListener("click", () => {
        window.location.href = "Totalorder.html";
    });
</script>
